---
layout: post
title: Scraping by Example - SelectMinds ATS
---

In this post I'll show how to develop a scraper for the SelectMinds Applicant Tracking System (ATS). For my example,
I'll use the jobs site at [https://eygbl.referrals.selectminds.com/](https://eygbl.referrals.selectminds.com/){:target="_blank"}

![search_page](/assets/eygbl/search_page.png)

Before developing the code for the scraper, let's inspect the site and see how the jobs are loaded into the page. Click on the
link above to load the page. Then open the Chrome developer tools and switch to the Network tab. Click the Search button to load
all jobs.

In the Network tab you'll see a series of XHR requests being made. I've highlighted the two requests that we'll need to recreate
in order to scrape the jobs from the site.

![0](/assets/eygbl/0.png)

The first request is a POST request to `https://eygbl.referrals.selectminds.com/ajax/jobs/search/create` with the following query
parameters and form data:

![1](/assets/eygbl/1.png)

This request is sent by the code in [job_search_banner.js](https://eygbl.referrals.selectminds.com/job_search_banner.js) which gets triggered
when the Search button is clicked:

```javascript
// Main submit binding
j$('#jSearchSubmit', search_banner).click(function() {
  ....
  j$.ajax({
    type: 'POST',
    url: TVAPP.guid('/ajax/jobs/search/create'),
    data: data,
    success: function(result){
      job_search_id = result.Result['JobSearch.id'];
      j$.log('job_search_id: ' + job_search_id);
      // Load results
      j$(document).trigger('loadSearchResults', {'job_search_id':job_search_id});
    },
    dataType: 'json',
    error: function(xhr, textStatus, error) {
      TVAPP.masterErrorHandler(xhr, textStatus, error, null);
    }
  });
});
```

The response sent back is a JSON string with the following fields:

```json
{
   "Status": "OK",
   "UserMessage": "",
   "Result": {
     "JobSearch.id": 84067040
   }
}
```

As shown in the code above, the `JobSearch` value from the response is passed as the argument to `loadSearchResults` which
is defined in [job_list.js](https://eygbl.referrals.selectminds.com/job_list.js):

```javascript
// function to find existing or get new search results
function loadSearchResults(data) {
  ...
  // load new results and display them
  if (cached_results.length && !data.force_refresh) {
    ...  
  } else {
    // Load new results
    var context = 'JobSearch.id=' + data.job_search_id;
    if (TVAPP.property.fb) context += '&fb=true';
    if (campaign_id) context += '&Campaign.id=' + campaign_id + '&campaign_page=2';
    if (data.page) context += '&page_index=' + data.page;

    // Sync load is bad news bears. instead, let's async and callback:
    j$.ajax({
      type: 'POST',
      url: TVAPP.guid('/ajax/content/job_results?' + context + '&site-name=' + TVAPP.property.site.short_name + '&include_site=true'),
      dataType: 'json',
      success: function(response) {
        var new_results = j$(response.Result);
        ...
        // display the new results
        displayLoadedResults(new_results, data);
      },
      error: function(xhr, textStatus,error) {
        TVAPP.masterErrorHandler(xhr, textStatus, error, null);
      }
    });
  }
};
```

This generates the second highlighted XHR request in the screenshot above. If we examine the request in the Network tab of the
Chrome developer tools we see a POST to

`https://eygbl.referrals.selectminds.com/ajax/content/job_results`

with the following query string parameters

![3](/assets/eygbl/3.png)

The HTML containing the jobs is inside the JSON response from this POST:

```json
{
  "Status":"OK", "UserMessage": "",
  "Result": "<div class=\"results_content..."
}
```


The URL is generated by the call `TVAPP.guid()`. Go into the console of the Chrome developer tools and type in `TVAPP.guid`.
The console will display the beginning of the code for this method. If you click on that code it will take you into Sources
tab shows that this method is defined in [desktop.js](https://eygbl.referrals.selectminds.com/desktop.js):

```javascript
TVAPP.guid = function(url) {
  var date = new Date
  var uid = date.getMilliseconds();

  var additionType = "?uid=";

  for (var i = 0; i < url.length; i++) {
    if(url.charAt(i) == '?') {
      additionType = "&uid="
    }
  }

  var newURL = url + additionType + uid;

  return newURL;
};
```